const { connectToDatabase } = require('../mongoConnection');

async function handleUserAuthentication(username, password) {
    console.log('Handling authentication request...');

    try {
        const db = await connectToDatabase();
        const userInformationCollection = db.collection('UserInformation');

        const user = await userInformationCollection.findOne({
            'user_name': { $regex: username, $options: 'i' }
        });

        if (user) {

            console.log('User found: ', user);

            if(password === user.password) {
                console.log('Correct password:', password);
                return true;
            } else {
                console.log('Wrong password: ', password);
                return false;
            }
        } else {
            console.log('User not found');
            return false;
        }
    } catch (error) {
        console.error('Error fetching user data:', error);
        throw error;
    }
}

module.exports = {
    handleUserAuthentication,
};
